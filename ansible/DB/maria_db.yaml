---
- hosts: DB-01
  become: yes
  vars_files:
    - /home/vagrant/main.yaml
  tasks:
    - include: /home/vagrant/install.yaml
    - name: Backup existing client.cnf file
      command: mv /etc/my.cnf.d/client.cnf /etc/my.cnf.d/client.bak
      args:
        creates: /etc/my.cnf.d/client.cnf.bak
      failed_when: false

    - name : mv my.cnf file
      command: mv /home/vagrant/client.cnf /etc/my.cnf.d/client.cnf

    - name: Backup existing mysql-clients.cnf file
      command: mv /etc/my.cnf.d/mysql-clients.cnf /etc/my.cnf.d/mysql-clients.bak
      args:
        creates: /etc/my.cnf.d/mysql-clients.cnf.bak
      failed_when: false
    - name : mv my.cnf file
      command: mv /home/vagrant/mysql-clients.cnf /etc/my.cnf.d/mysql-clients.cnf

    - name: Backup existing server.cnf file
      command: mv /etc/my.cnf.d/server.cnf /etc/my.cnf.d/server.bak
      args:
        creates: /etc/my.cnf.d/server.cnf.bak
      failed_when: false
    - name : mv my.cnf file
      command: mv /home/vagrant/server.cnf /etc/my.cnf.d/server.cnf


